borrowed some codes which cannot work for now.